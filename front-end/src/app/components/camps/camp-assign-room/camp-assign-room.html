<h1>Assegna a stanze</h1>

<form name="$ctrl.form" ng-submit="$ctrl.submit()" novalidate>
  <row style="grid-template-columns: 240px">
    <ew-daterange-picker name="daterange" on-change="$ctrl.onDaterangeFilter($event)" value="$ctrl.daterange">
    </ew-daterange-picker>
  </row>
</form>

<row style="grid-template-columns: 340px 1fr">
  <section>
    <!-- <pre>{{ $ctrl.camp.reservations | json }}</pre> -->
    <h3>Seleziona ospiti</h3>
    <input type="text" placeholder="Cerca ospite..." ng-model="$ctrl.search" />
    <div ng-repeat="res in $ctrl.camp.reservations | filter: $ctrl.search track by res.id">
      <label ng-if="!res.room_id">
        <input
          type="checkbox"
          ng-model="res.check"
          ng-change="$ctrl.countCheck(res.id, res.check)"
        />
        {{ res.guest.nome }} {{ res.guest.cognome }} | {{ res.data_previsto_in | date:'dd/MM/yyyy' }} - {{ res.data_previsto_out | date:'dd/MM/yyyy' }}
      </label>
    </div>
  </section>
  <section id="rooms">
    <!-- <pre>{{ $ctrl.rooms | json }}</pre> -->
    <row style="grid-template-columns: repeat(8, 70px)">
      <button
        ng-repeat="room in $ctrl.rooms track by room.id"
        class="room"
        ng-class="['color--' + room.disponibilita, { 'too-small': room.posti_liberi < $ctrl.countedChecks }]"
        ng-click="$ctrl.assegna(room)"
        ng-disabled="room.posti_liberi < $ctrl.countedChecks"
      >
        <h2>{{ room.display_name }}</h2>
        <i><small>{{ room.posti_liberi }}/</small>{{ room.posti_letto }}</i>
        <div class="room-daily-container">
          <span
          class="room-daily"
          ng-repeat="(k, day) in room.days track by k"
          ng-class="'color--' + day.disponibilita"
          >
        </div>
        </span>
      </button>
    </row>
  </section>
</row>
